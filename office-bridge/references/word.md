# Word Patterns

Word has full accessibility tree and ref-based editing helpers in addition to raw Office.js.

## Auto-Scroll

The add-in includes an "Auto-scroll to edits" toggle (enabled by default). When on, the document automatically scrolls to show the current selection after each code execution. This works for both helper methods and raw Office.js calls.

## Getting Documents

```typescript
const bridge = await connect();
const docs = await bridge.documents();  // Returns WordDocument[]
const doc = docs[0];
```

## Quick Start

```typescript
// Get accessibility tree
const tree = await doc.getTree({ verbosity: 'standard' });

// Edit by ref
await doc.replaceByRef('p:3', 'New text', { track: true });
await doc.insertAfterRef('p:5', ' (amended)', { track: true });
await doc.deleteByRef('p:7', { track: true });
```

## Detailed Guides

| Task | Guide |
|------|-------|
| Build tree, YAML serialization | [word/tree-building.md](word/tree-building.md) |
| Ref-based editing, batch ops | [word/editing.md](word/editing.md) |
| Text search, findAndHighlight | [word/search.md](word/search.md) |
| Accept/reject tracked changes | [word/tracked-changes.md](word/tracked-changes.md) |
| Comments: add, reply, resolve | [word/comments.md](word/comments.md) |
| Navigation helpers, getNextRef | [word/navigation.md](word/navigation.md) |
| Footnotes and endnotes | [word/footnotes.md](word/footnotes.md) |
| Hyperlink operations | [word/hyperlinks.md](word/hyperlinks.md) |
| Style management | [word/styles.md](word/styles.md) |
| Headers and footers | [word/headers-footers.md](word/headers-footers.md) |
| Table manipulation | [word/tables.md](word/tables.md) |
| Selection and cursor | [word/selection.md](word/selection.md) |
| First-time setup | [setup.md](setup.md) |

## Raw Office.js

For operations not covered by helpers:

```javascript
// Insert text at end
const body = context.document.body;
body.insertText("Hello!", Word.InsertLocation.end);
await context.sync();

// Get all paragraphs
const paragraphs = context.document.body.paragraphs;
paragraphs.load("items/text");
await context.sync();
return paragraphs.items.map(p => p.text);

// Search and replace
const results = context.document.body.search("old text", { matchCase: true });
results.load("items");
await context.sync();
for (const item of results.items) {
  item.insertText("new text", Word.InsertLocation.replace);
}
await context.sync();
```

## Tracked Changes

```typescript
// Edit options
{ track: true }           // Enable tracking
{ track: true, author: "Claude" }  // With author
```

See [word/tracked-changes.md](word/tracked-changes.md) for full details.

## Page Images

Get visual snapshots of the document as PNG images. Useful for agents to "see" the document.

```typescript
// Get all pages as images
const pages = await doc.getPageImages();
console.log(`Document has ${pages.length} pages`);
// pages[0].data is "data:image/png;base64,..."

// Get a single page
const page = await doc.getPageImage(1);

// With higher resolution
const pages = await doc.getPageImages({ scale: 2 });

// Specific pages only
const pages = await doc.getPageImages({ pages: [1, 3, 5] });
```

The images are generated by:
1. Exporting the document to PDF via Office.js
2. Converting each PDF page to a PNG image

This gives agents a way to visually verify their edits.

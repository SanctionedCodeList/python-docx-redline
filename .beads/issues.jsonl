{"id":"docx_redline-03e","title":"Implement TrackedXMLGenerator for insertions","description":"Create tracked_xml.py with TrackedXMLGenerator class. Generate \u003cw:ins\u003e XML with auto-incrementing IDs, timestamps, RSID, author. Handle xml:space='preserve'. See docs/IMPLEMENTATION_NOTES.md lines 280-317.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-12-06T08:39:51.907603-06:00","updated_at":"2025-12-06T11:01:12.647583-06:00","closed_at":"2025-12-06T11:01:12.647583-06:00","close_reason":"Closed","labels":["core"]}
{"id":"docx_redline-0i0","title":"Epic 1: MVP - Core Text Operations","description":"Implement core functionality to enable surgical edits without writing XML. Goal: Complete all 11 surgical edits from examples/surgical_edits.yaml using high-level API.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-12-06T08:39:30.392408-06:00","updated_at":"2025-12-08T08:02:04.809065-06:00","closed_at":"2025-12-08T08:02:04.809065-06:00","close_reason":"Closed","labels":["epic"]}
{"id":"docx_redline-1g2","title":"Create Section wrapper class","description":"Create a Section class to represent document sections (heading + paragraphs until next heading).\n\nRequirements:\n- Property: heading (the Paragraph that starts the section)\n- Property: paragraphs (all paragraphs in this section, including heading)\n- Property: heading_text (convenience property)\n- Property: heading_level (1-9)\n- Method: contains(text) - check if any paragraph in section contains text\n- Method: find_paragraph(text) - find first paragraph containing text\n- Class method: from_document(doc) -\u003e list[Section] - parse all sections\n\nImplementation notes:\n- A section is defined as: heading paragraph + all following paragraphs until the next heading\n- Paragraphs before the first heading belong to an implicit intro section\n- Should work with existing scope system (scope='section:Name')\n- Build on top of Paragraph class\n\nFiles to create:\n- src/docx_redline/models/section.py\n- tests/test_section.py\n\nDependencies:\n- Requires Paragraph class (docx_redline-yik)\n\nSuccess criteria:\n- Can parse document into sections\n- Can access section heading and paragraphs\n- Section detection matches existing scope system behavior\n- 10+ tests covering all methods","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-08T08:18:40.367621-06:00","updated_at":"2025-12-08T08:18:40.367621-06:00","labels":["core"]}
{"id":"docx_redline-37e","title":"Write README and basic documentation","description":"Create README.md with installation, quick start, basic examples. Link to docs/ folder for full API spec. Include the before/after code comparison to show value proposition.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:51.492926-06:00","updated_at":"2025-12-08T07:55:28.58129-06:00","closed_at":"2025-12-08T07:55:28.58129-06:00","close_reason":"completed","labels":["docs"]}
{"id":"docx_redline-3dx","title":"Implement batch operations (apply_edits)","description":"Add apply_edits(edits: list[dict]) method. Process list of edit specs in sequence. Return list of EditResult objects. See docs/PROPOSED_API.md lines 571-608.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:24.292971-06:00","updated_at":"2025-12-08T07:49:29.579584-06:00","closed_at":"2025-12-08T07:49:29.579584-06:00","close_reason":"completed","labels":["batch"]}
{"id":"docx_redline-47a","title":"Integration test: Complete surgical edits workflow","description":"End-to-end test using examples/surgical_edits.yaml. Must successfully apply all 11 edits. This is the success criteria for Phase 1 MVP. Create fixture document that matches the YAML edits.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-06T08:40:46.076275-06:00","updated_at":"2025-12-07T11:59:16.940807-06:00","closed_at":"2025-12-07T11:59:16.940807-06:00","close_reason":"blocked - requires replace_tracked, YAML support, and utilities","labels":["testing"]}
{"id":"docx_redline-7nh","title":"Implement delete_section() method","description":"Add delete_section() method to Document class for deleting entire sections with tracked changes.\n\nMethod signature:\ndef delete_section(\n    self,\n    heading: str,\n    track: bool = True,\n    update_toc: bool = False,\n    author: str | None = None\n) -\u003e Section:\n\nRequirements:\n- Find section by heading text\n- Delete heading paragraph + all paragraphs until next heading\n- If track=True, wrap all paragraphs in w:del elements\n- If track=False, delete elements completely\n- If update_toc=True, update any TOC fields (Phase 2 stretch goal)\n- Return the deleted Section object (for undo support)\n- Raise error if heading not found or ambiguous\n\nImplementation notes:\n- Use Section class to identify which paragraphs belong to section\n- Use existing scope system internally (scope='section:X')\n- For tracked deletion, wrap each paragraph in TrackedXMLGenerator.generate_deletion()\n- For untracked deletion, remove elements from tree\n- TOC update may need separate task if complex\n\nFiles to modify:\n- src/docx_redline/document.py\n- tests/test_structural_operations.py\n\nDependencies:\n- Section class (docx_redline-1g2)\n- Paragraph class (docx_redline-yik)\n\nSuccess criteria:\n- Can delete section by heading name\n- Tracked deletions work correctly\n- Untracked deletions work correctly\n- Proper error handling for missing/ambiguous headings\n- 8+ tests covering all scenarios\n- TOC update works (or marked as TODO for future)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-08T08:19:33.024815-06:00","updated_at":"2025-12-08T08:19:33.024815-06:00","labels":["core"]}
{"id":"docx_redline-8x1","title":"Epic 2: Phase 2 - Structural Operations","description":"Implement paragraph and section-level operations to enable complete document restructuring with tracked changes.\n\nGoal: Enable structural edits like adding new paragraphs, deleting entire sections, and updating TOCs.\n\nSuccess Criteria:\n- Can add new paragraphs with tracked changes\n- Can delete entire sections with tracked changes\n- Can update TOC automatically\n- All surgical_edits.yaml operations work\n\nDeliverables:\n- Paragraph and Section wrapper classes\n- insert_paragraph() and insert_paragraphs() methods\n- delete_section() with TOC updates\n- Comprehensive tests (\u003e85% coverage maintained)\n- Updated documentation","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-08T08:18:05.291164-06:00","updated_at":"2025-12-08T08:18:05.291164-06:00"}
{"id":"docx_redline-b23","title":"Add replace_tracked() and delete_tracked()","description":"Extend Document class with replace_tracked(find, replace, scope) and delete_tracked(text, scope). Replace needs \u003cw:del\u003e + \u003cw:ins\u003e. Delete needs \u003cw:del\u003e with \u003cw:delText\u003e. See docs/PROPOSED_API.md lines 286-345.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:13.507108-06:00","updated_at":"2025-12-07T12:09:47.73834-06:00","closed_at":"2025-12-07T12:09:47.73834-06:00","close_reason":"completed","labels":["core"]}
{"id":"docx_redline-bs9","title":"Create test suite for core operations","description":"Create tests/ directory with pytest tests. Test text_search with fragmented text, insert_tracked with various inputs, scope evaluation, error cases. Need test fixtures. Target \u003e80% coverage.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:40.565478-06:00","updated_at":"2025-12-08T08:01:13.326988-06:00","closed_at":"2025-12-08T08:01:13.326988-06:00","close_reason":"Closed","labels":["testing"]}
{"id":"docx_redline-c3m","title":"Create minimal Document class with insert_tracked()","description":"Create document.py with Document class. Load .docx, unpack if needed. Implement insert_tracked(text, after) - no scope yet. Use TextSearch to find text, TrackedXMLGenerator to create XML. Get ONE edit working end-to-end.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-06T08:39:57.294369-06:00","updated_at":"2025-12-07T11:54:47.188992-06:00","closed_at":"2025-12-07T11:54:47.188992-06:00","close_reason":"completed","labels":["core"]}
{"id":"docx_redline-eht","title":"Implement insert_paragraph() method","description":"Add insert_paragraph() method to Document class for inserting complete paragraphs with tracked changes.\n\nMethod signature:\ndef insert_paragraph(\n    self,\n    text: str,\n    after: str | None = None,\n    before: str | None = None,\n    style: str | None = None,\n    track: bool = True,\n    author: str | None = None,\n    scope: str | dict | Any | None = None\n) -\u003e Paragraph:\n\nRequirements:\n- Insert a complete new paragraph (w:p element)\n- Support both 'after' and 'before' positioning\n- Optional paragraph style (e.g., 'Normal', 'Heading1')\n- If track=True, wrap entire paragraph in w:ins element\n- If track=False, insert as accepted content\n- Return the created Paragraph object\n- Respect scope filters\n\nImplementation notes:\n- Need to find the anchor paragraph using existing search\n- Create new w:p element with w:r and w:t children\n- If tracked, wrap in TrackedXMLGenerator.generate_insertion()\n- Insert at correct position in document tree\n- Handle edge cases: insert after last paragraph, insert at beginning\n\nFiles to modify:\n- src/docx_redline/document.py\n- tests/test_structural_operations.py (create)\n\nDependencies:\n- Paragraph class (docx_redline-yik)\n\nSuccess criteria:\n- Can insert paragraph after/before specific text\n- Tracked insertions work correctly\n- Non-tracked insertions work correctly\n- Can specify paragraph style\n- 8+ tests covering all scenarios","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-08T08:18:58.452432-06:00","updated_at":"2025-12-08T08:18:58.452432-06:00","labels":["core"]}
{"id":"docx_redline-gnm","title":"Update documentation for Phase 2 features","description":"Update all documentation to reflect Phase 2 structural operations.\n\nFiles to update:\n\n1. **README.md**\n   - Add Phase 2 features to feature list\n   - Add examples for insert_paragraph(), insert_paragraphs(), delete_section()\n   - Update 'What's Working' section\n   - Update API reference section\n   - Update project status to 'Phase 2 Complete'\n\n2. **docs/TESTING.md**\n   - Document new test files (test_paragraph.py, test_section.py, test_structural_operations.py)\n   - Update coverage statistics\n   - Add Phase 2 operation examples\n\n3. **docs/PROPOSED_API.md**\n   - Mark Phase 2 as complete\n   - Update success criteria checklist\n\n4. **docs/IMPLEMENTATION_NOTES.md**\n   - Add implementation notes for Paragraph/Section classes\n   - Document design decisions\n   - Add troubleshooting notes\n\n5. **Create new guide** (optional)\n   - docs/STRUCTURAL_OPERATIONS.md - Deep dive on Phase 2 features\n\nRequirements:\n- All code examples must be tested and working\n- Update before/after comparisons if applicable\n- Ensure API documentation is accurate\n- Add real-world use case examples\n\nSuccess criteria:\n- README reflects all Phase 2 features\n- All docs are up to date\n- No TODO/placeholder sections remain\n- Examples can be copy-pasted and work","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-08T08:20:49.201521-06:00","updated_at":"2025-12-08T08:20:49.201521-06:00","labels":["docs"]}
{"id":"docx_redline-klh","title":"Implement basic scope system","description":"Create scope.py with ScopeEvaluator. Support string shortcuts: 'text' (paragraph containing), 'section:Name', 'heading:Name'. See docs/IMPLEMENTATION_NOTES.md lines 322-378. Parse scope spec, return callable that filters paragraphs.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:08.093686-06:00","updated_at":"2025-12-08T07:44:33.409945-06:00","closed_at":"2025-12-08T07:44:33.409945-06:00","close_reason":"completed","labels":["core"]}
{"id":"docx_redline-lrn","title":"Implement insert_paragraphs() method","description":"Add insert_paragraphs() method to Document class for inserting multiple paragraphs at once.\n\nMethod signature:\ndef insert_paragraphs(\n    self,\n    texts: list[str],\n    after: str | None = None,\n    before: str | None = None,\n    style: str | None = None,\n    track: bool = True,\n    author: str | None = None,\n    scope: str | dict | Any | None = None\n) -\u003e list[Paragraph]:\n\nRequirements:\n- Insert multiple paragraphs in sequence\n- All paragraphs get the same style (if specified)\n- All inserted with same tracking state\n- Maintain order: first text in list appears first in document\n- Return list of created Paragraph objects\n- More efficient than calling insert_paragraph() in a loop\n\nImplementation notes:\n- Should use insert_paragraph() internally for consistency\n- Need to handle positioning: each subsequent paragraph inserts after the previous one\n- Consider wrapping all in a single w:ins if tracked (implementation detail)\n\nFiles to modify:\n- src/docx_redline/document.py\n- tests/test_structural_operations.py\n\nDependencies:\n- insert_paragraph() (docx_redline-eht)\n\nSuccess criteria:\n- Can insert multiple paragraphs at once\n- Paragraphs appear in correct order\n- Tracked insertions work correctly\n- 5+ tests covering edge cases","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-08T08:19:14.448143-06:00","updated_at":"2025-12-08T08:19:14.448143-06:00","labels":["core"]}
{"id":"docx_redline-lvb","title":"Implement YAML file support (apply_edit_file)","description":"Add apply_edit_file(path) method. Parse YAML with preprocessing, edits, validation, output_options. Support all edit types from examples/surgical_edits.yaml. Use pyyaml library.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:29.70876-06:00","updated_at":"2025-12-08T07:52:17.433214-06:00","closed_at":"2025-12-08T07:52:17.433214-06:00","close_reason":"completed","labels":["batch"]}
{"id":"docx_redline-m8v","title":"Create integration tests for Phase 2 operations","description":"Add comprehensive integration tests demonstrating complete Phase 2 workflows.\n\nRequirements:\n- Test realistic document restructuring scenarios\n- Test combining Phase 1 and Phase 2 operations\n- Test surgical_edits.yaml example (or subset that's feasible)\n- Test error handling and edge cases\n- Ensure 85%+ coverage is maintained\n\nTest scenarios to cover:\n1. Add multiple paragraphs to a section with tracked changes\n2. Delete an entire section and verify TOC updates\n3. Mix text edits (Phase 1) with structural edits (Phase 2)\n4. Apply Phase 2 operations from YAML file\n5. Error recovery when section not found\n6. Complex document with multiple sections and TOC\n\nFiles to modify:\n- tests/test_integration.py (add new tests)\n- tests/test_structural_operations.py (if not already comprehensive)\n\nDependencies:\n- All Phase 2 operations implemented\n\nSuccess criteria:\n- 5+ new integration tests\n- Tests cover realistic use cases\n- All tests pass\n- Coverage remains \u003e85%\n- Demonstrates value of Phase 2 features","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-08T08:20:29.068636-06:00","updated_at":"2025-12-08T08:20:29.068636-06:00","labels":["testing"]}
{"id":"docx_redline-uj2","title":"Implement custom exception classes","description":"Create errors.py with DocxRedlineError, TextNotFoundError, AmbiguousTextError, ValidationError. Include helpful __str__ methods with suggestions. See docs/IMPLEMENTATION_NOTES.md lines 448-490.","status":"closed","priority":2,"issue_type":"task","assignee":"Claude","created_at":"2025-12-06T08:39:41.151381-06:00","updated_at":"2025-12-06T09:20:09.438051-06:00","closed_at":"2025-12-06T09:20:09.438051-06:00","close_reason":"Closed","labels":["foundation"]}
{"id":"docx_redline-ut5","title":"Add Phase 2 operations to batch/YAML support","description":"Extend apply_edits() and YAML support to handle new Phase 2 structural operations.\n\nRequirements:\n- Add support for 'insert_paragraph' edit type\n- Add support for 'insert_paragraphs' edit type\n- Add support for 'delete_section' edit type\n- Update EditResult to handle these operations\n- Ensure all parameters are supported in YAML/dict format\n\nYAML format examples:\nedits:\n  - type: insert_paragraph\n    text: 'New paragraph content'\n    after: 'anchor text'\n    style: 'Normal'\n    track: true\n    \n  - type: insert_paragraphs\n    texts: ['Para 1', 'Para 2', 'Para 3']\n    before: 'anchor text'\n    track: true\n    \n  - type: delete_section\n    heading: 'Section Title'\n    track: true\n    update_toc: true\n\nFiles to modify:\n- src/docx_redline/document.py (apply_edits method)\n- tests/test_batch_operations.py\n- tests/test_yaml_support.py\n\nDependencies:\n- All Phase 2 operation methods (docx_redline-eht, docx_redline-lrn, docx_redline-7nh)\n\nSuccess criteria:\n- Can specify all Phase 2 operations in YAML\n- apply_edits() correctly dispatches to new operations\n- EditResult messages are informative\n- 10+ tests for new operation types in batch mode","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-08T08:20:12.287477-06:00","updated_at":"2025-12-08T08:20:12.287477-06:00","labels":["batch"]}
{"id":"docx_redline-vtz","title":"Add accept_all_changes() and delete_all_comments()","description":"Implement accept_all_changes() - remove all \u003cw:ins\u003e wrappers, delete all \u003cw:del\u003e content. Implement delete_all_comments() - remove all comment elements. These are preprocessing operations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:35.140426-06:00","updated_at":"2025-12-07T12:32:27.2614-06:00","closed_at":"2025-12-07T12:32:27.2614-06:00","close_reason":"completed","labels":["utility"]}
{"id":"docx_redline-vvi","title":"Set up Python package structure","description":"Create pyproject.toml, src/docx_redline/__init__.py, basic directory structure. Dependencies: lxml, python-dateutil, pyyaml. Use modern Python packaging. Target Python 3.10+.","status":"closed","priority":2,"issue_type":"task","assignee":"Claude","created_at":"2025-12-06T08:39:35.767332-06:00","updated_at":"2025-12-06T09:06:24.31418-06:00","closed_at":"2025-12-06T09:06:24.31418-06:00","close_reason":"Closed","labels":["setup"]}
{"id":"docx_redline-wq7","title":"Add error handling with suggestions","description":"Implement SuggestionGenerator for helpful error messages. When text not found, try fuzzy match, search without scope, check for common issues (curly quotes, double spaces). See docs/IMPLEMENTATION_NOTES.md lines 494-522.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:18.891673-06:00","updated_at":"2025-12-08T07:36:52.609623-06:00","closed_at":"2025-12-08T07:36:52.609623-06:00","close_reason":"completed","labels":["polish"]}
{"id":"docx_redline-xpe","title":"Implement TOC update functionality","description":"Add Table of Contents update functionality to automatically refresh TOC after structural changes.\n\nRequirements:\n- Detect TOC fields in document (w:sdt with w:docPartGallery='Table of Contents')\n- Update TOC to reflect current document structure\n- Handle multiple TOCs in same document\n- Mark TOC as needing update (Word will regenerate on open)\n- Or fully regenerate TOC if possible\n\nImplementation approaches to consider:\n1. Simple: Set w:fldDirty='true' on TOC fields (Word updates on open)\n2. Medium: Update TOC XML structure directly\n3. Complex: Fully regenerate TOC from document headings\n\nFiles to create:\n- src/docx_redline/toc.py\n- tests/test_toc.py\n\nImplementation notes:\n- Approach 1 (dirty flag) is simplest and most reliable\n- Word handles the actual regeneration\n- Should work with delete_section(update_toc=True)\n\nSuccess criteria:\n- TOC fields are marked for update after section deletion\n- Word successfully regenerates TOC when opening document\n- 5+ tests for TOC detection and update marking\n- Works with delete_section() integration","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-08T08:19:53.038453-06:00","updated_at":"2025-12-08T08:19:53.038453-06:00","labels":["utility"]}
{"id":"docx_redline-ye8","title":"Implement text search with fragmentation handling","description":"Create text_search.py with TextSearch class. Core algorithm: build character map across runs, find text, map back to run indices. This is THE critical piece. See docs/IMPLEMENTATION_NOTES.md lines 227-274. Must handle text split across multiple \u003cw:r\u003e elements.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-12-06T08:39:46.536923-06:00","updated_at":"2025-12-06T09:21:48.981693-06:00","closed_at":"2025-12-06T09:21:48.981693-06:00","close_reason":"Closed","labels":["core"]}
{"id":"docx_redline-yik","title":"Create Paragraph wrapper class","description":"Create a Paragraph class to wrap w:p XML elements with convenient methods.\n\nRequirements:\n- Wrap lxml Element representing a w:p\n- Property: text (get/set paragraph text)\n- Property: style (get/set paragraph style)\n- Property: runs (access w:r elements)\n- Method: is_heading() - detect if paragraph is a heading\n- Method: get_heading_level() - return heading level (1-9) or None\n- Method: contains(text) - check if paragraph contains text\n- Property: parent (access parent Section if in one)\n\nImplementation notes:\n- Similar pattern to python-docx Paragraph class\n- Keep it simple - just wrap the XML, don't duplicate Document logic\n- Should work with existing scope system\n\nFiles to create:\n- src/docx_redline/models/paragraph.py\n- tests/test_paragraph.py\n\nSuccess criteria:\n- Can create Paragraph from w:p element\n- Can read/write text and style properties\n- Heading detection works correctly\n- 10+ tests covering all methods","status":"open","priority":0,"issue_type":"task","created_at":"2025-12-08T08:18:23.118867-06:00","updated_at":"2025-12-08T08:18:23.118867-06:00","labels":["core"]}
{"id":"docx_redline-yk0","title":"Implement TextSpan class","description":"Create text_span.py with TextSpan dataclass. Represents found text across potentially multiple runs. Properties: text, context, location. Methods: insert_before(), insert_after(), replace(), delete(). See docs/PROPOSED_API.md lines 684-716.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-06T08:40:02.685708-06:00","updated_at":"2025-12-07T12:34:55.845742-06:00","closed_at":"2025-12-07T12:34:55.845742-06:00","close_reason":"completed","labels":["core"]}
